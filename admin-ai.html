<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PMERIT Admin AI Assistant</title>
  <style>
    body { 
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      font-family: 'Inter', sans-serif; 
      margin: 0;
      padding: 2rem;
      min-height: 100vh;
    }
    .admin-ai-container {
      max-width: 600px;
      margin: 2rem auto;
      background: rgba(255,255,255,0.95);
      border-radius: 15px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
      padding: 2rem;
    }
    .admin-ai-header {
      text-align: center;
      margin-bottom: 1.5rem;
    }
    .admin-ai-header h2 { 
      color: #667eea; 
      margin-bottom: 0.5rem;
    }
    .mission-text {
      font-size: 0.9rem;
      color: #666;
      font-style: italic;
    }
    .admin-ai-chat-box { 
      min-height: 300px; 
      border: 1px solid #e5e7eb; 
      border-radius: 12px; 
      padding: 1.5rem; 
      background: #fafaff; 
      margin-bottom: 1rem; 
      overflow-y: auto;
      max-height: 400px;
    }
    .admin-ai-msg { 
      margin-bottom: 1rem; 
      padding: 0.75rem;
      border-radius: 8px;
    }
    .admin-ai-msg.admin { 
      background: rgba(102, 126, 234, 0.1);
      color: #667eea; 
      border-left: 4px solid #667eea;
    }
    .admin-ai-msg.ai { 
      background: rgba(118, 75, 162, 0.1);
      color: #444; 
      border-left: 4px solid #764ba2;
      white-space: pre-wrap;
    }
    .admin-ai-form { 
      display: flex; 
      gap: 0.75rem; 
    }
    .admin-ai-form input { 
      flex: 1; 
      padding: 0.75rem; 
      border-radius: 8px; 
      border: 1px solid #e2e8f0; 
      font-size: 1rem;
    }
    .admin-ai-form button { 
      padding: 0.75rem 1.5rem; 
      background: #667eea; 
      color: #fff; 
      border: none; 
      border-radius: 8px; 
      cursor: pointer; 
      font-size: 1rem;
      transition: background 0.2s;
    }
    .admin-ai-form button:hover {
      background: #764ba2;
    }
    .admin-ai-form button:disabled { 
      background: #ccc; 
      cursor: not-allowed; 
    }
    .admin-ai-login { 
      text-align: center; 
      margin-top: 1.5rem; 
    }
    .admin-ai-login input {
      padding: 0.75rem;
      border-radius: 8px;
      border: 1px solid #e2e8f0;
      width: 70%;
      font-size: 1rem;
      margin-bottom: 1rem;
    }
    .admin-ai-login button {
      padding: 0.75rem 2rem;
      background: #667eea;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
    }
    .status-indicator {
      text-align: center;
      margin-bottom: 1rem;
      padding: 0.5rem;
      border-radius: 8px;
      background: rgba(34, 197, 94, 0.1);
      color: #16a34a;
      font-size: 0.9rem;
    }
  </style>
</head>
<body>
  <div class="admin-ai-container">
    <div class="admin-ai-header">
      <h2>ü§ñ PMERIT Admin AI Assistant</h2>
      <div class="mission-text">Breaking poverty cycles through accessible education</div>
      <div class="mission-text">Global AI-powered development assistance</div>
    </div>
    
    <div id="adminLogin" class="admin-ai-login">
      <h3>Admin Authentication</h3>
      <input type="password" id="adminPass" placeholder="Enter admin password" autocomplete="off"/>
      <br>
      <button onclick="adminLogin()">üîê Login to AI Assistant</button>
      <div id="adminLoginMsg" style="color:#ef4444;margin-top:1rem;"></div>
    </div>
    
    <div id="adminAIBox" style="display:none;">
      <div class="status-indicator">
        ‚úÖ Connected to PMERIT Diagnostic Bot Backend
      </div>
      <div class="admin-ai-chat-box" id="adminAIChat">
        <div class="admin-ai-msg ai">
          <strong>Gabriel AI:</strong> Welcome to the PMERIT Administrative AI Assistant! üéì

I'm here to help you optimize the educational platform for students in underserved communities. 

Try asking:
- "What security issues should I fix for student data?"
- "How to optimize for Nigerian mobile users?"
- "Analyze authentication vulnerabilities"
- "Check mobile accessibility issues"
        </div>
      </div>
      <form class="admin-ai-form" onsubmit="return sendAdminAI()">
        <input type="text" id="adminAIInput" placeholder="Ask about platform optimization, security, accessibility..." autocomplete="off" required/>
        <button id="adminAISendBtn" type="submit">Send</button>
      </form>
    </div>
  </div>
  
  <script>
    const ADMIN_PASSWORD = "Ipinle24689_S";

    function adminLogin() {
      const pass = document.getElementById('adminPass').value;
      const msgDiv = document.getElementById('adminLoginMsg');
      
      if (pass === ADMIN_PASSWORD) {
        document.getElementById('adminLogin').style.display = 'none';
        document.getElementById('adminAIBox').style.display = '';
        document.getElementById('adminAIInput').focus();
        msgDiv.innerText = "";
      } else {
        msgDiv.innerText = "‚ùå Incorrect password. Use the admin password from your backend.";
      }
    }

    function sendAdminAI() {
      const input = document.getElementById('adminAIInput');
      const chat = document.getElementById('adminAIChat');
      const sendBtn = document.getElementById('adminAISendBtn');
      const question = input.value.trim();
      
      if (!question) return false;

      const adminMsg = document.createElement('div');
      adminMsg.className = "admin-ai-msg admin";
      adminMsg.innerHTML = `<strong>You:</strong> ${question}`;
      chat.appendChild(adminMsg);

      input.value = "";
      sendBtn.disabled = true;
      sendBtn.textContent = "Analyzing...";

      fetch('http://localhost:8080/api/admin-ai', {
        method: 'POST',
        headers: { 
          'Content-Type': 'application/json',
          'x-admin-password': ADMIN_PASSWORD
        },
        body: JSON.stringify({ question: question })
      })
      .then(resp => {
        if (!resp.ok) {
          throw new Error(`HTTP ${resp.status}: ${resp.statusText}`);
        }
        return resp.json();
      })
      .then(data => {
        const aiMsg = document.createElement('div');
        aiMsg.className = "admin-ai-msg ai";
        aiMsg.innerHTML = `<strong>Gabriel AI:</strong> ${data.answer}`;
        chat.appendChild(aiMsg);
        chat.scrollTop = chat.scrollHeight;
        sendBtn.disabled = false;
        sendBtn.textContent = "Send";
      })
      .catch(e => {
        const aiMsg = document.createElement('div');
        aiMsg.className = "admin-ai-msg ai";
        aiMsg.innerHTML = `<strong>Gabriel AI:</strong> ‚ùå Connection Error: ${e.message}

üîß Troubleshooting:
- Make sure backend is running on localhost:8080
- Check admin password: ${ADMIN_PASSWORD}
- Verify CORS settings in backend`;
        chat.appendChild(aiMsg);
        sendBtn.disabled = false;
        sendBtn.textContent = "Send";
      });

      return false;
    }
  </script>
</body>
</html>
